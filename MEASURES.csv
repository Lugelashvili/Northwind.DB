MEASURE_DISPLAY_FOLDER,MEASURE_NAME,EXPRESSION
,__Default measure,1
Current Year,Sales YTD LY (LatestDataYear),"VAR _last = CALCULATE( MAX( 'FactsTable'[OrderDate] ), ALL( 'FactsTable' ) )
VAR _prevStart = DATE( YEAR(_last) - 1, 1, 1 )
VAR _prevEnd   = DATE( YEAR(_last) - 1, MONTH(_last), DAY(_last) )
RETURN
CALCULATE(
  [Total Sales (LineTotal)],
  FILTER( ALL( 'FactsTable' ),
    'FactsTable'[OrderDate] >= _prevStart &&
    'FactsTable'[OrderDate] <= _prevEnd
  )
)"
Current Year,Sales Delta by Category,[Sales Latest Year by Category] - [Sales Prior Year by Category]
Current Year,Orders - Latest Year (by month),"VAR _MaxDate = [LatestOrderDate]
VAR _CY = YEAR( _MaxDate )
VAR _ThisMonth = MAX( FactsTable[MonthNum] )
RETURN
CALCULATE(
    DISTINCTCOUNT( FactsTable[OrderID] ),
    FILTER(
        ALL( FactsTable ),
        YEAR( FactsTable[OrderDate] ) = _CY
        && FactsTable[MonthNum] = _ThisMonth
    )
)"
Current Year,AOV - Prior Year (by month),"VAR _sales = [Sales - Prior Year (by month)]
VAR _orders = [Orders - Prior Year (by month)]
RETURN
IF( ISBLANK(_sales) && ISBLANK(_orders), BLANK(), DIVIDE( _sales, _orders, 0 ) )"
Current Year,Sales YTD LY For Waterfall,"VAR _max = [LatestOrderDate]
VAR _py = YEAR(_max) - 1
VAR _m = MONTH(_max)
VAR _d = DAY(_max)
RETURN
CALCULATE(
    [Total Sales (LineTotal) for current Year],
    FILTER(
        ALL( FactsTable ),
        YEAR( FactsTable[OrderDate] ) = _py
        && (
            MONTH( FactsTable[OrderDate] ) < _m
            || ( MONTH( FactsTable[OrderDate] ) = _m && DAY( FactsTable[OrderDate] ) <= _d )
        )
    )
)"
Current Year,LatestOrderDate,"CALCULATE(
    MAX( FactsTable[OrderDate] ),
    ALL( FactsTable )
)"
Current Year,LatestYear,YEAR( [LatestOrderDate] )
Current Year,Sales LY (Selected Year),"VAR sel = SELECTEDVALUE( 'FactsTable'[OrderYear] )
RETURN
IF( ISBLANK(sel), BLANK(),
  CALCULATE( [Total Sales (LineTotal)],
    FILTER( ALL('FactsTable'),
      YEAR( 'FactsTable'[OrderDate] ) = sel - 1
    )
  )
)"
Current Year,Sales YTD YoY % (Latest),"VAR cur = [Sales YTD (LatestDataYear)]
VAR prev = [Sales YTD LY (LatestDataYear)]
RETURN IF( ISBLANK(prev), BLANK(), DIVIDE( cur - prev, prev ) )"
Current Year,Orders - Prior Year (by month),"VAR _MaxDate = [LatestOrderDate]
VAR _PY = YEAR( _MaxDate ) - 1
VAR _ThisMonth = MAX( FactsTable[MonthNum] )
RETURN
CALCULATE(
    DISTINCTCOUNT( FactsTable[OrderID] ),
    FILTER(
        ALL( FactsTable ),
        YEAR( FactsTable[OrderDate] ) = _PY
        && FactsTable[MonthNum] = _ThisMonth
    )
)"
Current Year,AOV - Latest Year (by month),"VAR _sales = [Sales - Latest Year (by month)]
VAR _orders = [Orders - Latest Year (by month)]
RETURN
IF( ISBLANK(_sales) && ISBLANK(_orders), BLANK(), DIVIDE( _sales, _orders, 0 ) )"
Current Year,Sales - Prior Year (by month),"VAR _MaxDate = [LatestOrderDate]
VAR _PY = YEAR( _MaxDate ) - 1
VAR _ThisMonth = MAX( FactsTable[MonthNum] )
RETURN
CALCULATE(
    [Total Sales (LineTotal) for current Year],
    FILTER(
        ALL( FactsTable ),
        YEAR( FactsTable[OrderDate] ) = _PY
        && FactsTable[MonthNum] = _ThisMonth
    )
)"
Current Year,YoY Color orders (Latest),"VAR v = [Orders YTD YoY % (LatestDates)]
RETURN
IF (
    ISBLANK(v),
    ""#808080"",                -- grey when no value
    IF ( v >= 0, ""#2E7D32"",   -- green
                 ""#C62828"" )  -- red
)"
Current Year,Sales Latest Year by Category,"VAR _max = [LatestOrderDate]
VAR _yr = YEAR( _max )
RETURN
CALCULATE(
    [Total Sales (LineTotal) for current Year],
    FILTER(
        ALL( FactsTable[OrderDate] ),
        YEAR( FactsTable[OrderDate] ) = _yr
        && FactsTable[OrderDate] <= _max
    )
)"
Current Year,Sales YTD For Waterfall,"VAR _max = [LatestOrderDate]
VAR _yr = YEAR(_max)
VAR _end = _max
RETURN
CALCULATE(
    [Total Sales (LineTotal) for current Year],
    FILTER(
        ALL( FactsTable ),
        YEAR( FactsTable[OrderDate] ) = _yr
        && FactsTable[OrderDate] <= _end
    )
)"
Current Year,AOV YoY % (Latest vs Prior),"VAR _cur = [AOV - Latest Year (by month)]
VAR _prev = [AOV - Prior Year (by month)]
RETURN IF( ISBLANK(_cur) && ISBLANK(_prev), BLANK(), DIVIDE( _cur - _prev, _prev, 0 ) )"
Current Year,Orders YTD to MaxDate LY,"VAR MaxOrderDate = MAX( FactsTable[OrderDate] )
VAR MaxDateOnly = DATE( YEAR(MaxOrderDate), MONTH(MaxOrderDate), DAY(MaxOrderDate) )

VAR PrevYear = YEAR(MaxDateOnly) - 1
// handle Feb 29 => map to Feb 28 in non-leap previous years
VAR PrevDay =
    IF( MONTH(MaxDateOnly) = 2 && DAY(MaxDateOnly) = 29 &&
        NOT (
            ( MOD( PrevYear, 400 ) = 0 ) ||
            ( MOD( PrevYear, 4 ) = 0 && MOD( PrevYear, 100 ) <> 0 )
        ),
        28,
        DAY(MaxDateOnly)
    )
VAR PrevEnd = DATE( PrevYear, MONTH(MaxDateOnly), PrevDay )
VAR PrevStart = DATE( PrevYear, 1, 1 )

RETURN
CALCULATE(
    DISTINCTCOUNT( FactsTable[OrderDate] ),
    FILTER(
        ALL( FactsTable[OrderDate] ),
        DATEVALUE( FactsTable[OrderDate] ) >= PrevStart &&
        DATEVALUE( FactsTable[OrderDate] ) <= PrevEnd
    )
)"
Current Year,Sales - Latest Year (by month),"VAR _MaxDate = [LatestOrderDate]
VAR _CY = YEAR( _MaxDate )
VAR _ThisMonth = MAX( FactsTable[MonthNum] )
RETURN
CALCULATE(
    [Total Sales (LineTotal) for current Year],
    FILTER(
        ALL( FactsTable ),
        YEAR( FactsTable[OrderDate] ) = _CY
        && FactsTable[MonthNum] = _ThisMonth
    )
)"
Current Year,Sales YTD (LatestDataYear),"VAR _last = CALCULATE( MAX( 'FactsTable'[OrderDate] ), ALL( 'FactsTable' ) )
VAR _start = DATE( YEAR(_last), 1, 1 )
RETURN
CALCULATE(
  [Total Sales (LineTotal)],
  FILTER( ALL( 'FactsTable' ),
    'FactsTable'[OrderDate] >= _start &&
    'FactsTable'[OrderDate] <= _last
  )
)"
Current Year,Orders YTD YoY % (LatestDates),"VAR Curr = [Orders YTD to MaxDate]
VAR Prev = [Orders YTD to MaxDate LY]
RETURN
IF( OR( ISBLANK( Prev ), Prev = 0 ), BLANK(), DIVIDE( Curr - Prev, Prev ) )"
Current Year,Sales Prior Year by Category,"VAR _max = [LatestOrderDate]
VAR _py = YEAR( _max ) - 1
VAR _m = MONTH( _max )
VAR _d = DAY( _max )
RETURN
CALCULATE(
    [Total Sales (LineTotal) for current Year],
    FILTER(
        ALL( FactsTable[OrderDate] ),
        YEAR( FactsTable[OrderDate] ) = _py
        && (
            MONTH( FactsTable[OrderDate] ) < _m
            || ( MONTH( FactsTable[OrderDate] ) = _m && DAY( FactsTable[OrderDate] ) <= _d )
        )
    )
)"
Current Year,Total Sales (LineTotal) for current Year,SUM(FactsTable[LineTotal])
Current Year,Orders YTD to MaxDate,"VAR MaxOrderDate = MAX( FactsTable[OrderDate] )
VAR MaxDateOnly = DATE( YEAR(MaxOrderDate), MONTH(MaxOrderDate), DAY(MaxOrderDate) )
VAR StartThisYear = DATE( YEAR(MaxDateOnly), 1, 1 )
RETURN
CALCULATE(
    DISTINCTCOUNT( FactsTable[OrderDate] ),
    FILTER(
        ALL( FactsTable[OrderDate] ), 
        DATEVALUE( FactsTable[OrderDate] ) >= StartThisYear &&
        DATEVALUE( FactsTable[OrderDate] ) <= MaxDateOnly
    )
)"
Current Year,Sales YoY % (Latest vs Prior),"VAR _cur = [Sales - Latest Year (by month)]
VAR _prev = [Sales - Prior Year (by month)]
RETURN
IF( ISBLANK(_cur) && ISBLANK(_prev), BLANK(),
    DIVIDE( _cur - _prev, _prev, 0 )
)"
Customers Analysis,Repeat Purchase Rate (all data),"VAR CustTable = DISTINCT( ALL( FactsTable[CustomerID] ) )
VAR RepeatCust =
    COUNTROWS(
        FILTER(
            CustTable,
            CALCULATE( DISTINCTCOUNT( FactsTable[OrderID] ) ) > 1
        )
    )
VAR TotCust = COUNTROWS( CustTable )
RETURN DIVIDE( RepeatCust, TotCust, 0 )"
Customers Analysis,New Customers YTD,"VAR EndOfPeriod = MAX(FactsTable[OrderDate].[Date])
VAR YearStart = DATE( YEAR( EndOfPeriod ), 1, 1 )
RETURN
CALCULATE(
  DISTINCTCOUNT( FactsTable[CustomerID] ),
  FILTER(
    VALUES( FactsTable[CustomerID] ),
    CALCULATE( MIN( FactsTable[OrderDate] ) ) >= YearStart
  )
)"
Customers Analysis,AOV  CA,"DIVIDE( [Total Sales CA], [Total Orders CA] )"
Customers Analysis,Customers in Bucket,DISTINCTCOUNT( DimCustomers[CustomerID] )
Customers Analysis,Pct Customers in Bucket,"DIVIDE( 
  CALCULATE( DISTINCTCOUNT( DimCustomers[CustomerID] ) ), 
  CALCULATE( DISTINCTCOUNT( DimCustomers[CustomerID] ), ALL( DimCustomers[CustomerSalesBucket] ) ), 
  0
)"
Customers Analysis,Pct Sales in Bucket,"DIVIDE(
  CALCULATE( [Total Sales CA] ),
  CALCULATE( [Total Sales CA], ALL( DimCustomers[CustomerSalesBucket] ) ),
  0
)"
Customers Analysis,Total Sales CA,SUM( FactsTable[LineTotal] )
Customers Analysis,Total Customers (Dim),DISTINCTCOUNT( DimCustomers[CustomerID] )
Customers Analysis,Avg Orders per Customer,"DIVIDE( [Total Orders CA], [Total Customers  CA] )"
Customers Analysis,Last Order Date,MAX( FactsTable[OrderDate] )
Customers Analysis,Total Customers  CA,DISTINCTCOUNT( FactsTable[CustomerID] )
Customers Analysis,Sales in Bucket,"CALCULATE(
  [Total Sales CA],
  VALUES( DimCustomers[CustomerID] )
)"
Customers Analysis,Total Orders CA,DISTINCTCOUNT( FactsTable[OrderID] )
Customers Analysis,Total Quantity CA,SUM( FactsTable[Quantity] )
Customers Analysis,Avg Customer LTV,"DIVIDE( [Total Sales CA], [Total Customers  CA] )"
Employee,Active Employees 12M,"CALCULATE(
  DISTINCTCOUNT( FactsTable[EmployeeID] ),
  DATESINPERIOD( FactsTable[OrderDate].[Date], MAX(FactsTable[OrderDate]), -12, MONTH )
)"
Employee,Sales per Employee YTD,"DIVIDE(
  [Total Sales E],
  DISTINCTCOUNT( FactsTable[EmployeeID] )
)"
Employee,Total Sales E,SUM( FactsTable[LineTotal] )
Employee,Orders per Employee YTD,"DIVIDE( [Total Orders], DISTINCTCOUNT( FactsTable[EmployeeID] ) )"
Employee,Total Orders  E,DISTINCTCOUNT( FactsTable[OrderID] )
Employee,Total Quantity E,SUM( FactsTable[Quantity] )
Employee,Total Customers E,DISTINCTCOUNT( FactsTable[CustomerID] )
Employee,Avg Tenure (yrs) - AsOf 2023-10-28,"VAR AsOf = DATE(2023, 10, 28)
VAR Emps =
    FILTER(
        'DimEmployee',
        NOT( ISBLANK( 'DimEmployee'[HireDate] ) )
        && 'DimEmployee'[HireDate] <= AsOf
    )
RETURN
AVERAGEX(
    Emps,
    DIVIDE( DATEDIFF( 'DimEmployee'[HireDate], AsOf, DAY ), 365.2425 )
)"
Employee,Avg Age (yrs) - From age_at_latest_order,"AVERAGEX(
    FILTER( 'DimEmployee', NOT( ISBLANK( 'DimEmployee'[age_at_latest_order] ) ) ),
    'DimEmployee'[age_at_latest_order]
)"
Employee,AOV E,"DIVIDE( [Total Sales E], [Total Orders  E] )"
Employee,Top Employee Sales,"CALCULATE(
  MAXX( SUMMARIZE( DimEmployee, DimEmployee[EmployeeID], ""S"", CALCULATE([Total Sales E]) ), [S] )
)"
Executive Sales history,Top 5 Customers Share % (Selected Year),"VAR EndYear = MAX('FactsTable'[OrderYear])
VAR BaseCtx = FILTER( ALL('FactsTable'[OrderYear]), 'FactsTable'[OrderYear]=EndYear )
VAR Top5Sales =
    SUMX(
      TOPN(5, VALUES('DimCustomers'[CustomerID]),
           CALCULATE([Total Sales (LineTotal)], BaseCtx), DESC),
      CALCULATE([Total Sales (LineTotal)], BaseCtx)
    )
VAR TotalSalesTY = CALCULATE([Total Sales (LineTotal)], BaseCtx)
RETURN DIVIDE( Top5Sales, TotalSalesTY )"
Executive Sales history,YoY Color (Selected Year),"VAR v = [Sales YoY % (Selected Year)]
RETURN
IF (
    ISBLANK(v),
    ""#808080"",                -- grey when no value
    IF ( v >= 0, ""#2E7D32"",   -- green
                 ""#C62828"" )  -- red
)"
Executive Sales history,Title Year Range,"VAR minY = MIN('FactsTable'[OrderYear])
VAR maxY = MAX('FactsTable'[OrderYear])
RETURN ""Sales History — Years: "" & minY & ""–"" & maxY"
Executive Sales history,Total Orders,DISTINCTCOUNT(FactsTable[OrderID])
Executive Sales history,Average Order Value,"DIVIDE([Total Sales (LineTotal)],[Total Orders])"
Executive Sales history,Data As Of,"FORMAT( [LastFactDates], ""MMM dd, yyyy"" )"
Executive Sales history,LastFactDates,"CALCULATE( MAX( 'FactsTable'[OrderDate] ), ALL( 'FactsTable' ) )"
Executive Sales history,Active customers (selected year),"VAR EndYear = MAX( 'FactsTable'[OrderYear] )
RETURN
CALCULATE(
    DISTINCTCOUNT( 'FactsTable'[CustomerID] ),
    FILTER( ALL( 'FactsTable'[OrderYear] ), 'FactsTable'[OrderYear] = EndYear )
)"
Executive Sales history,Sales % of Year,"VAR _cur = [Total Sales (LineTotal)]
VAR _yrTotal =
    CALCULATE(
        [Total Sales (LineTotal)],
        ALLEXCEPT('FactsTable', 'FactsTable'[OrderYear])   -- keep Year, remove Month
    )
RETURN DIVIDE(_cur, _yrTotal)"
Executive Sales history,Sales YoY % (Selected Year),"VAR _year =
    SELECTEDVALUE(
        'FactsTable'[OrderYear],                                  -- year from slicer/axis
        YEAR( CALCULATE( MAX('FactsTable'[OrderDate]), ALL('FactsTable') ) )   -- fallback = latest fact year
    )
VAR _cur  =
    CALCULATE( [Total Sales (LineTotal)],
        FILTER( ALL('FactsTable'), YEAR('FactsTable'[OrderDate]) = _year )
    )
VAR _prev =
    CALCULATE( [Total Sales (LineTotal)],
        FILTER( ALL('FactsTable'), YEAR('FactsTable'[OrderDate]) = _year - 1 )
    )
RETURN IF( _prev = 0 || ISBLANK(_prev), BLANK(), DIVIDE( _cur - _prev, _prev ) )"
Executive Sales history,Total Discount Amount,"SUMX( 'FactsTable', 'FactsTable'[UnitPrice] * 'FactsTable'[Quantity] * 'FactsTable'[Discount] )"
Executive Sales history,Total Sales (LineTotal),SUM(FactsTable[LineTotal])
Orders Operations,AOV O,"DIVIDE( [Total Sales O], [Orders Count] )"
Orders Operations,Total Customers 0,DISTINCTCOUNT( FactsTable[CustomerID] )
Orders Operations,Total Quantity O,SUM( FactsTable[Quantity] )
Orders Operations,Orders Count,COUNTROWS( Orders )
Orders Operations,Total Sales O,SUM( FactsTable[LineTotal] )
Orders Operations,LatePct_Cell,"VAR LateInCell = CALCULATE( [Late Orders], ALLSELECTED(), VALUES( Orders[OrderWeekday] ), VALUES( Orders[OrderHour] ) )
VAR TotalInCell = CALCULATE( [Orders Count], ALLSELECTED(), VALUES( Orders[OrderWeekday] ), VALUES( Orders[OrderHour] ) )
RETURN DIVIDE( LateInCell, TotalInCell, 0 )"
Orders Operations,Late Rate,"VAR Valid = CALCULATE( COUNTROWS( Orders ), NOT( ISBLANK( Orders[RequiredDate] ) ) )
RETURN DIVIDE( [Late Orders], Valid, 0 )"
Orders Operations,Late Orders,"CALCULATE( COUNTROWS( Orders ), Orders[IsLate] = 1 )"
Orders Operations,OnTime Orders (distinct),"VAR OrdersSummary =
    ADDCOLUMNS(
        SUMMARIZE( FactsTable, FactsTable[OrderID] ),
        ""Shipped"",  CALCULATE( MIN( FactsTable[ShippedDate] ) ),
        ""Required"", CALCULATE( MIN( FactsTable[RequiredDate] ) )
    )
VAR ValidOrders = FILTER( OrdersSummary, NOT( ISBLANK([Required]) ) )
VAR OnTime =
    FILTER(
        ValidOrders,
        ( NOT( ISBLANK([Shipped]) ) && [Shipped] <= [Required] )
        || ( ISBLANK([Shipped]) && TODAY() <= [Required] )   -- pending but not past required
    )
RETURN
COUNTROWS( OnTime )"
Orders Operations,Median DaysToShip (Late),"MEDIANX( FILTER( Orders, Orders[IsLate] = 1 && NOT( ISBLANK( Orders[DaysToShip] ) ) ), Orders[DaysToShip] )"
Orders Operations,Orders Count  why,DISTINCTCOUNT( FactsTable[OrderID] )
Orders Operations,Open Orders (distinct),"VAR Orders =
    ADDCOLUMNS(
        VALUES( FactsTable[OrderID] ),
        ""Shipped"", CALCULATE( MIN( FactsTable[ShippedDate] ) )
    )
RETURN
COUNTROWS( FILTER( Orders, ISBLANK([Shipped]) ) )"
Orders Operations,Orders by Size (distinct),"VAR OrdersSummary =
    ADDCOLUMNS(
        SUMMARIZE( FactsTable, FactsTable[OrderID] ),
        ""TotalQty"", CALCULATE( SUM( FactsTable[Quantity] ) ),
        ""Size"", 
            SWITCH(
                TRUE(),
                CALCULATE( SUM( FactsTable[Quantity] ) ) <= 5, ""Small"",
                CALCULATE( SUM( FactsTable[Quantity] ) ) <= 20, ""Medium"",
                ""Large""
            )
    )
VAR ThisSize = SELECTEDVALUE( 'FactsTable'[OrderSize] )  -- optional if you use a disconnected size table
RETURN
COUNTROWS( FILTER( OrdersSummary, [Size] = ThisSize ) )"
Orders Operations,Fill Rate,"VAR OrdersPerOrder =
    SUMMARIZE(
        FactsTable,
        FactsTable[OrderID],
        ""ShipDate"", MIN( FactsTable[ShippedDate] )
    )
VAR FilledOrders =
    COUNTROWS( FILTER( OrdersPerOrder, NOT( ISBLANK( [ShipDate] ) ) ) )
VAR Total = [Total Orders pcp]
RETURN
    DIVIDE( FilledOrders, Total, 0 )"
Orders Operations,On Time % (incl pending within window),"VAR Orders =
    ADDCOLUMNS(
        SUMMARIZE( FactsTable, FactsTable[OrderID] ),
        ""Shipped"",  CALCULATE( MIN( FactsTable[ShippedDate] ) ),
        ""Required"", CALCULATE( MIN( FactsTable[RequiredDate] ) )
    )
VAR OrdersWithReq = FILTER( Orders, NOT( ISBLANK( [Required] ) ) )
VAR TotalOrders = COUNTROWS( OrdersWithReq )
VAR OnTimeOrders =
    COUNTROWS(
        FILTER(
            OrdersWithReq,
            (
                ( NOT( ISBLANK( [Shipped] ) ) && [Shipped] <= [Required] )        -- shipped on or before required
                ||
                ( ISBLANK( [Shipped] ) && TODAY() <= [Required] )                 -- not shipped yet but required date not passed
            )
        )
    )
RETURN
    DIVIDE( OnTimeOrders, TotalOrders, 0 )"
Orders Operations,Avg Days to Ship,"AVERAGEX(
  FILTER( FactsTable, NOT( ISBLANK( FactsTable[ShippedDate] ) ) ),
  DATEDIFF( FactsTable[OrderDate], FactsTable[ShippedDate], DAY )
)"
Orders Operations,Orders Count Selected Size,"VAR sel = SELECTEDVALUE( Orders[OrderSize] )
RETURN
IF(
    ISBLANK(sel),
    [Orders Count],                                     -- show total if nothing selected
    CALCULATE( COUNTROWS( Orders ), Orders[OrderSize] = sel )
)"
Product & Category Performance,AOV pcp,"DIVIDE( [Total Sales pcp], [Total Orders pcp] )"
Product & Category Performance,Total Customers pcp,DISTINCTCOUNT( FactsTable[CustomerID] )
Product & Category Performance,Total Quantity pcp,SUM( FactsTable[Quantity] )
Product & Category Performance,Total Orders pcp,DISTINCTCOUNT( FactsTable[OrderID] )
Product & Category Performance,Sales Delta %,"VAR TotalDelta = CALCULATE( [Sales Delta], ALLSELECTED( FactsTable[CategoryName] ) )
VAR ThisDelta = [Sales Delta]
RETURN DIVIDE( ThisDelta, TotalDelta, 0 )"
Product & Category Performance,YoY Color orders products,"VAR v = [Product Sales YoY %]
RETURN
IF (
    ISBLANK(v),
    ""#808080"",                -- grey when no value
    IF ( v >= 0, ""#2E7D32"",   -- green
                 ""#C62828"" )  -- red
)"
Product & Category Performance,Sales Delta,"[Total Sales pcp]
- CALCULATE( [Total Sales pcp], SAMEPERIODLASTYEAR( FactsTable[OrderDate].[Date]) )"
Product & Category Performance,Top Product Sales %,"VAR ThisProdSales = SUM( FactsTable[LineTotal] )
VAR Total = CALCULATE( SUM( FactsTable[LineTotal] ), ALLSELECTED( FactsTable[ProductName] ) )
RETURN DIVIDE( ThisProdSales, Total, 0 )"
Product & Category Performance,Product Sales YoY %,"VAR Curr = [Total Sales pcp]
VAR Prev = CALCULATE( [Total Sales pcp], SAMEPERIODLASTYEAR( FactsTable[OrderDate].[Date] ) )
RETURN DIVIDE( Curr - Prev, Prev, 0 )"
Product & Category Performance,Avg Unit Price,"DIVIDE( SUM( FactsTable[LineTotal] ), SUM( FactsTable[Quantity] ), 0 )"
Product & Category Performance,Units Sold,SUM( FactsTable[Quantity] )
Product & Category Performance,Avg Selling Price,"DIVIDE( [Total Sales pcp], [Total Quantity pcp] )"
Product & Category Performance,Active SKUs,DISTINCTCOUNT( FactsTable[ProductID] )
Product & Category Performance,Top SKU Sales,"MAXX( SUMMARIZE( FactsTable, FactsTable[ProductID], ""S"", CALCULATE([Total Sales pcp]) ), [S] )"
Product & Category Performance,Category Sales,"CALCULATE( [Total Sales pcp], ALLEXCEPT( FactsTable, FactsTable[CategoryName] ) )"
Product & Category Performance,Total Sales pcp,SUM( FactsTable[LineTotal] )
